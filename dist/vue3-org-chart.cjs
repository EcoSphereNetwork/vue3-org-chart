"use strict";const e=require("vue"),B=require("panzoom"),w={class:"vue3-org-chart-node"},N={key:0,class:"vue3-org-chart-node-element-top-line"},x=["onKeydown"],E={key:1,class:"vue3-org-chart-node-element-bottom-line"},V={key:0,class:"vue3-org-chart-node-container"},I={__name:"Node",props:{id:String},setup(m){const a=m,h=e.ref(null),u=e.inject("data"),c=e.ref(!1),l=u.value.find(t=>t.id===a.id),f=e.inject("panzoomInstance");e.inject("scene");const g=e.inject("container"),i=()=>{r.length&&(c.value=!c.value,v())},v=()=>{const t=g.value.getBoundingClientRect(),o=h.value.getBoundingClientRect(),d=t.x+t.width/2,s=t.y+t.height/4,p=o.x+o.width/2,_=o.y+o.height/2,k=d-p,y=s-_;f.value.moveBy(k,y,!0)},n=t=>u.value.filter(o=>o.parentId===t),r=e.reactive(n(a.id));return(t,o)=>{const d=e.resolveComponent("Node",!0);return e.openBlock(),e.createElementBlock("div",w,[e.renderSlot(t.$slots,"top-border"),e.createElementVNode("div",{class:"vue3-org-chart-node-element",ref_key:"element",ref:h},[e.unref(l).parentId?(e.openBlock(),e.createElementBlock("div",N)):e.createCommentVNode("",!0),e.createElementVNode("div",{tabindex:"0",onKeydown:e.withKeys(e.withModifiers(v,["self","prevent"]),["space"])},[e.renderSlot(t.$slots,"node",{item:e.unref(l),nodes:r,show:c.value,handleChildren:i})],40,x),r.length&&c.value?(e.openBlock(),e.createElementBlock("div",E)):e.createCommentVNode("",!0)],512),e.createVNode(e.Transition,{name:"nodeTransition"},{default:e.withCtx(()=>[r.length&&c.value?(e.openBlock(),e.createElementBlock("div",V,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r,(s,p)=>(e.openBlock(),e.createBlock(d,{key:s.id,id:s.id,ref_for:!0,ref:"nodeRefs"},{"top-border":e.withCtx(()=>[e.createElementVNode("div",{class:e.normalizeClass(["vue3-org-chart-node-element-horizontal-line",{left:c.value&&p!==0,right:c.value&&p!==r.length-1}])},null,2)]),node:e.withCtx(({item:_,nodes:k,show:y,handleChildren:C})=>[e.renderSlot(t.$slots,"node",{item:_,nodes:k,show:y,handleChildren:C})]),_:2},1032,["id"]))),128))])):e.createCommentVNode("",!0)]),_:3})])}}},b={class:"vue3-org-chart"},j={key:1},z={__name:"Vue3OrgChart",props:{data:{type:Array,default:()=>[]},json:{type:String,default:""}},setup(m){const a=e.ref(null),h=e.ref(null),u=m,c=async n=>await(await fetch(n)).json(),l=e.ref(u.data);e.onMounted(async()=>{if(u.json){const n=await c(u.json);l.value=n}}),e.provide("data",l);const f=()=>l.value.find(n=>n.parentId===""||!n.parentId),g=()=>f().id,i=e.ref(null);e.provide("panzoomInstance",i),e.provide("scene",a),e.provide("container",h),e.onMounted(()=>{i.value=B(a.value,{zoomDoubleClickSpeed:1.4,maxZoom:5,minZoom:.1,initialX:0,initialZoom:1,bounds:!1})});const v=()=>{const n=i.value.getTransform(),r=0,t=0;if(n.scale!==1){const o=1-n.scale,d=n.x/o,s=n.y/o;i.value.smoothZoomAbs(d,s,1)}else i.value.smoothMoveTo(r,t,1)};return(n,r)=>(e.openBlock(),e.createElementBlock("div",b,[e.createElementVNode("button",{onClick:v},"Reset Zoom"),e.createElementVNode("div",{ref_key:"container",ref:h,class:"vue3-org-chart-container"},[e.createElementVNode("div",{ref_key:"scene",ref:a,class:"vue3-org-chart-scene"},[l.value.length?(e.openBlock(),e.createBlock(I,{id:g(),key:"root"},{node:e.withCtx(({item:t,nodes:o,show:d,handleChildren:s})=>[e.renderSlot(n.$slots,"node",{item:t,nodes:o,show:d,handleChildren:s})]),_:3},8,["id"])):(e.openBlock(),e.createElementBlock("div",j," No data "))],512)],512)]))}},S={install(m,a={}){m.component("Vue3OrgChart",z)}};module.exports=S;
