"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("vue"),B=require("panzoom"),C={class:"vue3-org-chart-node"},w={key:0,class:"vue3-org-chart-node-element-top-line"},V={key:1,class:"vue3-org-chart-node-element-bottom-line"},N={key:0,class:"vue3-org-chart-node-container"},E={__name:"Node",props:{id:String},setup(a){const o=a,r=e.ref(null),{data:l}=e.inject("content"),t=e.ref(!1),c=e.inject("api"),i=c.find(o.id),s=e.reactive(l.value.filter(d=>d.parentId===o.id));e.onMounted(()=>{i.parentId||(c.$root.value=r.value,c.reset())});const f=()=>{s.length&&(t.value=!t.value,c.goToHome(r.value))};return(d,n)=>{const m=e.resolveComponent("Node",!0);return e.openBlock(),e.createElementBlock("div",C,[e.renderSlot(d.$slots,"top-border"),e.createElementVNode("div",{class:"vue3-org-chart-node-element",ref_key:"element",ref:r},[e.unref(i).parentId?(e.openBlock(),e.createElementBlock("div",w)):e.createCommentVNode("",!0),e.createElementVNode("div",{tabindex:"0",onKeydown:n[0]||(n[0]=e.withKeys(e.withModifiers(u=>e.unref(c).goToHome(r.value),["self","prevent"]),["space"]))},[e.renderSlot(d.$slots,"node",{item:e.unref(i),nodes:s,show:t.value,toggleChildren:f})],32),s.length&&t.value?(e.openBlock(),e.createElementBlock("div",V)):e.createCommentVNode("",!0)],512),e.createVNode(e.Transition,{name:"nodeTransition"},{default:e.withCtx(()=>[s.length&&t.value?(e.openBlock(),e.createElementBlock("div",N,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s,(u,v)=>(e.openBlock(),e.createBlock(m,{key:u.id,id:u.id,ref_for:!0,ref:"nodeRefs"},{"top-border":e.withCtx(()=>[e.createElementVNode("div",{class:e.normalizeClass(["vue3-org-chart-node-element-horizontal-line",{left:t.value&&v!==0,right:t.value&&v!==s.length-1}])},null,2)]),node:e.withCtx(({item:p,nodes:h,show:g,toggleChildren:k})=>[e.renderSlot(d.$slots,"node",{item:p,nodes:h,show:g,toggleChildren:k})]),_:2},1032,["id"]))),128))])):e.createCommentVNode("",!0)]),_:3})])}}};function $(){const a=e.ref(),o=e.ref(null),r=e.ref(null);function l(){a.value=B(o.value,{zoomDoubleClickSpeed:1.4,maxZoom:5,minZoom:.1,initialZoom:1,bounds:!1})}return e.onMounted(()=>{a.value||l()}),{scene:o,container:r,instance:a}}function S({initialData:a,json:o}){const r=e.ref(!0),l=e.ref(a),t=async c=>await(await fetch(c)).json();return e.onMounted(async()=>{o&&(l.value=await t(o)),r.value=!1}),{data:l,loading:r}}function b(a,o,r){const l=e.ref(null),t=e.reactive({x:0,y:40});function c(n){return o.value.find(m=>m.id===n)}function i(){return o.value.find(n=>n.parentId===""||!n.parentId)}function s(){return i().id}function f(){d(l.value)}function d(n){const m=r.value.getBoundingClientRect(),u=n.getBoundingClientRect(),v=m.x+m.width/2+t.x,p=m.y+t.y,h=u.x+u.width/2,g=u.y,k=v-h,y=p-g;a.value.moveBy(k,y,!0)}return{reset:f,$root:l,root:i,rootId:s,find:c,goToHome:d}}const x={class:"vue3-org-chart"},I={key:1},T={key:0},j={key:1},_={__name:"Vue3OrgChart",props:{data:{type:Array,default:()=>[]},json:{type:String,default:""}},emits:["onReady"],setup(a,{emit:o}){const r=a,{instance:l,scene:t,container:c}=$();e.provide("panzoom",{instance:l,scene:t,container:c});const{data:i,loading:s}=S({initialData:r.data,json:r.json});e.provide("content",{data:i,loading:s});const f=b(l,i,c);e.provide("api",f);const d=o;return e.watch(()=>s.value,n=>{n||d("onReady",{api:f})}),(n,m)=>(e.openBlock(),e.createElementBlock("div",x,[e.createElementVNode("div",{ref_key:"container",ref:c,class:"vue3-org-chart-container"},[e.createElementVNode("div",{ref_key:"scene",ref:t,class:"vue3-org-chart-scene"},[e.unref(i).length?(e.openBlock(),e.createBlock(E,{id:e.unref(f).rootId(),key:"root"},{node:e.withCtx(({item:u,nodes:v,show:p,toggleChildren:h})=>[e.renderSlot(n.$slots,"node",{item:u,nodes:v,show:p,toggleChildren:h})]),_:3},8,["id"])):(e.openBlock(),e.createElementBlock("div",I,[e.unref(s)?(e.openBlock(),e.createElementBlock("span",T,[e.renderSlot(n.$slots,"loading",{},()=>[e.createTextVNode("Loading...")])])):(e.openBlock(),e.createElementBlock("span",j,[e.renderSlot(n.$slots,"no-data",{},()=>[e.createTextVNode("No data")])]))]))],512)],512)]))}},z={install(a,o={}){a.component("Vue3OrgChart",_)}};exports.Vue3OrgChart=_;exports.Vue3OrgChartPlugin=z;
