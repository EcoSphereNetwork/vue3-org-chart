"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("vue"),B=require("panzoom"),w={class:"vue3-org-chart-node"},N={key:0,class:"vue3-org-chart-node-element-top-line"},V=["onKeydown"],x={key:1,class:"vue3-org-chart-node-element-bottom-line"},E={key:0,class:"vue3-org-chart-node-container"},S={__name:"Node",props:{id:String},setup(u){const m=u,h=e.ref(null),v=e.inject("data"),o=e.ref(!1),p=v.value.find(n=>n.id===m.id),r=e.reactive(v.value.filter(n=>n.parentId===m.id)),c=e.inject("panzoomInstance"),g=e.inject("container"),_=()=>{r.length&&(o.value=!o.value,f())},f=()=>{const n=g.value.getBoundingClientRect(),t=h.value.getBoundingClientRect(),l=n.x+n.width/2,s=n.y+n.height/4,a=t.x+t.width/2,i=t.y+t.height/2,d=l-a,k=s-i;c.value.moveBy(d,k,!0)};return(n,t)=>{const l=e.resolveComponent("Node",!0);return e.openBlock(),e.createElementBlock("div",w,[e.renderSlot(n.$slots,"top-border"),e.createElementVNode("div",{class:"vue3-org-chart-node-element",ref_key:"element",ref:h},[e.unref(p).parentId?(e.openBlock(),e.createElementBlock("div",N)):e.createCommentVNode("",!0),e.createElementVNode("div",{tabindex:"0",onKeydown:e.withKeys(e.withModifiers(f,["self","prevent"]),["space"])},[e.renderSlot(n.$slots,"node",{item:e.unref(p),nodes:r,show:o.value,handleChildren:_})],40,V),r.length&&o.value?(e.openBlock(),e.createElementBlock("div",x)):e.createCommentVNode("",!0)],512),e.createVNode(e.Transition,{name:"nodeTransition"},{default:e.withCtx(()=>[r.length&&o.value?(e.openBlock(),e.createElementBlock("div",E,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r,(s,a)=>(e.openBlock(),e.createBlock(l,{key:s.id,id:s.id,ref_for:!0,ref:"nodeRefs"},{"top-border":e.withCtx(()=>[e.createElementVNode("div",{class:e.normalizeClass(["vue3-org-chart-node-element-horizontal-line",{left:o.value&&a!==0,right:o.value&&a!==r.length-1}])},null,2)]),node:e.withCtx(({item:i,nodes:d,show:k,handleChildren:C})=>[e.renderSlot(n.$slots,"node",{item:i,nodes:d,show:k,handleChildren:C})]),_:2},1032,["id"]))),128))])):e.createCommentVNode("",!0)]),_:3})])}}},b={class:"vue3-org-chart"},I={key:1},y={__name:"Vue3OrgChart",props:{data:{type:Array,default:()=>[]},json:{type:String,default:""}},emits:["onReady"],setup(u,{emit:m}){const h=e.ref(null),v=e.ref(null),o=u,p=m,r=e.ref(o.data),c=e.ref();e.provide("data",r),e.provide("panzoomInstance",c),e.provide("container",v);const g=async t=>await(await fetch(t)).json();e.onMounted(async()=>{o.json&&(r.value=await g(o.json)),p("onReady",{api:{reset:_}})}),e.onMounted(()=>{c.value=B(h.value,{zoomDoubleClickSpeed:1.4,maxZoom:5,minZoom:.1,initialX:0,initialZoom:1,bounds:!1})});const _=()=>{const t=c.value.getTransform(),l=0,s=0;if(t.scale!==1){const a=1-t.scale,i=t.x/a,d=t.y/a;c.value.smoothZoomAbs(i,d,1)}else c.value.smoothMoveTo(l,s,1)},f=()=>r.value.find(t=>t.parentId===""||!t.parentId),n=()=>f().id;return(t,l)=>(e.openBlock(),e.createElementBlock("div",b,[e.createElementVNode("div",{ref_key:"container",ref:v,class:"vue3-org-chart-container"},[e.createElementVNode("div",{ref_key:"scene",ref:h,class:"vue3-org-chart-scene"},[r.value.length?(e.openBlock(),e.createBlock(S,{id:n(),key:"root"},{node:e.withCtx(({item:s,nodes:a,show:i,handleChildren:d})=>[e.renderSlot(t.$slots,"node",{item:s,nodes:a,show:i,handleChildren:d})]),_:3},8,["id"])):(e.openBlock(),e.createElementBlock("div",I,[e.renderSlot(t.$slots,"no-data",{},()=>[e.createTextVNode(" No data ")])]))],512)],512)]))}},j={install(u,m={}){u.component("Vue3OrgChart",y)}};exports.Vue3OrgChart=y;exports.Vue3OrgChartPlugin=j;
