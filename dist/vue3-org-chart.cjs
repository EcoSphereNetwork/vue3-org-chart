"use strict";const e=require("vue"),C=require("panzoom"),B={class:"vue3-org-chart-node"},w={key:0,class:"vue3-org-chart-node-element-top-line"},N=["onKeydown"],x={key:1,class:"vue3-org-chart-node-element-bottom-line"},E={key:0,class:"vue3-org-chart-node-container"},V={__name:"Node",props:{id:String},setup(u){const m=u,h=e.ref(null),v=e.inject("data"),o=e.ref(!1),p=v.value.find(n=>n.id===m.id),r=e.reactive(v.value.filter(n=>n.parentId===m.id)),c=e.inject("panzoomInstance"),g=e.inject("container"),_=()=>{r.length&&(o.value=!o.value,f())},f=()=>{const n=g.value.getBoundingClientRect(),t=h.value.getBoundingClientRect(),l=n.x+n.width/2,a=n.y+n.height/4,s=t.x+t.width/2,i=t.y+t.height/2,d=l-s,k=a-i;c.value.moveBy(d,k,!0)};return(n,t)=>{const l=e.resolveComponent("Node",!0);return e.openBlock(),e.createElementBlock("div",B,[e.renderSlot(n.$slots,"top-border"),e.createElementVNode("div",{class:"vue3-org-chart-node-element",ref_key:"element",ref:h},[e.unref(p).parentId?(e.openBlock(),e.createElementBlock("div",w)):e.createCommentVNode("",!0),e.createElementVNode("div",{tabindex:"0",onKeydown:e.withKeys(e.withModifiers(f,["self","prevent"]),["space"])},[e.renderSlot(n.$slots,"node",{item:e.unref(p),nodes:r,show:o.value,handleChildren:_})],40,N),r.length&&o.value?(e.openBlock(),e.createElementBlock("div",x)):e.createCommentVNode("",!0)],512),e.createVNode(e.Transition,{name:"nodeTransition"},{default:e.withCtx(()=>[r.length&&o.value?(e.openBlock(),e.createElementBlock("div",E,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r,(a,s)=>(e.openBlock(),e.createBlock(l,{key:a.id,id:a.id,ref_for:!0,ref:"nodeRefs"},{"top-border":e.withCtx(()=>[e.createElementVNode("div",{class:e.normalizeClass(["vue3-org-chart-node-element-horizontal-line",{left:o.value&&s!==0,right:o.value&&s!==r.length-1}])},null,2)]),node:e.withCtx(({item:i,nodes:d,show:k,handleChildren:y})=>[e.renderSlot(n.$slots,"node",{item:i,nodes:d,show:k,handleChildren:y})]),_:2},1032,["id"]))),128))])):e.createCommentVNode("",!0)]),_:3})])}}},I={class:"vue3-org-chart"},S={key:1},z={__name:"Vue3OrgChart",props:{data:{type:Array,default:()=>[]},json:{type:String,default:""}},emits:["onReady"],setup(u,{emit:m}){const h=e.ref(null),v=e.ref(null),o=u,p=m,r=e.ref(o.data),c=e.ref();e.provide("data",r),e.provide("panzoomInstance",c),e.provide("container",v);const g=async t=>await(await fetch(t)).json();e.onMounted(async()=>{o.json&&(r.value=await g(o.json)),p("onReady",{api:{reset:_}})}),e.onMounted(()=>{c.value=C(h.value,{zoomDoubleClickSpeed:1.4,maxZoom:5,minZoom:.1,initialX:0,initialZoom:1,bounds:!1})});const _=()=>{const t=c.value.getTransform(),l=0,a=0;if(t.scale!==1){const s=1-t.scale,i=t.x/s,d=t.y/s;c.value.smoothZoomAbs(i,d,1)}else c.value.smoothMoveTo(l,a,1)},f=()=>r.value.find(t=>t.parentId===""||!t.parentId),n=()=>f().id;return(t,l)=>(e.openBlock(),e.createElementBlock("div",I,[e.createElementVNode("div",{ref_key:"container",ref:v,class:"vue3-org-chart-container"},[e.createElementVNode("div",{ref_key:"scene",ref:h,class:"vue3-org-chart-scene"},[r.value.length?(e.openBlock(),e.createBlock(V,{id:n(),key:"root"},{node:e.withCtx(({item:a,nodes:s,show:i,handleChildren:d})=>[e.renderSlot(t.$slots,"node",{item:a,nodes:s,show:i,handleChildren:d})]),_:3},8,["id"])):(e.openBlock(),e.createElementBlock("div",S,[e.renderSlot(t.$slots,"no-data",{},()=>[e.createTextVNode(" No data ")])]))],512)],512)]))}},R={install(u,m={}){u.component("Vue3OrgChart",z)}};module.exports=R;
